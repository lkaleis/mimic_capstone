#Stage 4 Mortality Prediction SVM model

install.packages("e1071")
library(e1071)

#support vector machine algorithm
#choose parameters using tune() function (cost, gamma) 
#accuracy depends on selection of these parameters
tuned <- tune.svm(hospital_expire_flag~., data = traindata, gamma = 10^(-6:-1), cost = 10^(-1:1))
summary(tuned)

#best parameters are gamma = 0.01 and cost = 10
model  <- svm(hospital_expire_flag~., data=traindata, kernel = "radial", gamma = 0.01, cost = 10) 
summary(model)
prediction <- predict(model, testdata[,-1])
tab <- table(pred = prediction, true = testdata[,1])
tab

#accuracy of 0.8346
confusionMatrix(tab)
tuned$best.performance
plot.svm(model, traindata)
